<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Recommendation</title>
    <link rel="stylesheet" href="/static/style2.css">
    <link rel="stylesheet" href="/static/style1.css">
</head>


<body>
    


    <div class="noise"></div>
    <div class="bg-gradient"></div>
    <div class="bg-gradient-2"></div>
    
    <div class="container">
        
        <header>
      <div class="logo" onclick="window.location.href='/'">
        <svg class="logo-icon" width="40" height="40" viewBox="0 0 40 40">
          <path d="M20 0C8.954 0 0 8.954 0 20s8.954 20 20 20 20-8.954 20-20S31.046 0 20 0z" fill="#00c853" opacity="0.2"/>
          <path d="M22 10c-6.075 0-11 4.925-11 11s4.925 11 11 11 11-4.925 11-11-4.925-11-11-11z" fill="#00c853" opacity="0.4"/>
          <path d="M24 15c-3.314 0-6 2.686-6 6s2.686 6 6 6 6-2.686 6-6-2.686-6-6-6z" fill="#00c853" opacity="0.7"/>
          <path d="M26 20c0 1.105-0.895 2-2 2s-2-0.895-2-2 0.895-2 2-2 2 0.895 2 2z" fill="#00c853"/>
        </svg>
        <span class="logo-text">EcoCropx</span>
      </div>
      
      <nav>
        <div class="nav-items">
          <ul>
            <li><a href="/">Home</a></li>
            <li><a href="/index">Crop Recommendation</a></li>
            <li><a href="/about">About</a></li>
            <li><a href="/contact">Contact</a></li>
          </ul>
        </div>

        <div class="mobile-menu">&#9776;</div>
      </nav>
    
    </header>
    
    
    
    <div class="app-container">
        <div class="app-header">
        
            <h1 class="app-title">EcoCropx</h1>
            <p class="app-subtitle">Get intelligent crop suggestions based on your location and soil data</p>
        </div>
        
        <div class="form-container">
            <form id="cropForm">
                <div class="card">
                    <div class="card-header">
                        <div class="card-icon">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M12 2C8.13 2 5 5.13 5 9C5 14.25 12 22 12 22C12 22 19 14.25 19 9C19 5.13 15.87 2 12 2Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                <path d="M12 11C13.1046 11 14 10.1046 14 9C14 7.89543 13.1046 7 12 7C10.8954 7 10 7.89543 10 9C10 10.1046 10.8954 11 12 11Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                        </div>
                        <h2 class="card-title">Location Information</h2>
                    </div>
                    <div class="card-body">
                        <div class="form-group full-width">
                            <label for="city">City</label>
                            <div class="input-with-icon">
                                <span class="input-icon">
                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M12 2C8.13 2 5 5.13 5 9C5 14.25 12 22 12 22C12 22 19 14.25 19 9C19 5.13 15.87 2 12 2Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                    </svg>
                                </span>
                                <input type="text" id="city" placeholder=" Enter your city" required oninput="getWeather()">
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="card">
                    <div class="card-header">
                        <div class="card-icon">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M17 8C17 10.7614 14.7614 13 12 13C9.23858 13 7 10.7614 7 8C7 5.23858 9.23858 3 12 3C14.7614 3 17 5.23858 17 8Z" stroke="currentColor" stroke-width="2"/>
                                <path d="M3 21C3.95728 17.2022 7.29053 14 12 14C16.7095 14 20.0427 17.2022 21 21" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                            </svg>
                        </div>
                        <h2 class="card-title">Soil Nutrients</h2>
                    </div>
                    <div class="card-body">
                        <div class="form-grid">
                            <div class="form-group">
                                <label for="nitrogen">
                                    Nitrogen (N)
                                    <span class="tooltip">
                                        <span class="tooltip-icon">?</span>
                                        <span class="tooltip-content">Nitrogen is essential for leaf growth and green coloration in plants.</span>
                                    </span>
                                </label>
                                <input type="number" id="nitrogen" placeholder="Enter nitrogen value" min="0" max="140" required>
                            </div>
                            
                            <div class="form-group">
                                <label for="phosphorus">
                                    Phosphorus (P)
                                    <span class="tooltip">
                                        <span class="tooltip-icon">?</span>
                                        <span class="tooltip-content">Phosphorus promotes root growth and flower/fruit development.</span>
                                    </span>
                                </label>
                                <input type="number" id="phosphorus" placeholder="Enter phosphorus value" min="0" max="140" required>
                            </div>
                            
                            <div class="form-group">
                                <label for="potassium">
                                    Potassium (K)
                                    <span class="tooltip">
                                        <span class="tooltip-icon">?</span>
                                        <span class="tooltip-content">Potassium helps in overall plant health and disease resistance.</span>
                                    </span>
                                </label>
                                <input type="number" id="potassium" placeholder="Enter potassium value" min="0" max="200" required>
                            </div>
                            
                            <div class="form-group">
                                <label for="ph">
                                    pH Level
                                    <span class="tooltip">
                                        <span class="tooltip-icon">?</span>
                                        <span class="tooltip-content">pH indicates soil acidity/alkalinity. Optimal range is usually 5.5-7.5.</span>
                                    </span>
                                </label>
                                <input type="number" id="ph" placeholder="Enter pH value" min="0" max="14" step="0.1" required>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="card">
                    <div class="card-header">
                        <div class="card-icon">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M8 16.5C8 17.8807 9.11929 19 10.5 19C11.8807 19 13 17.8807 13 16.5C13 15.1193 10.5 12 10.5 12C10.5 12 8 15.1193 8 16.5Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                <path d="M5 8C5 9.65685 6.34315 11 8 11C9.65685 11 11 9.65685 11 8C11 6.34315 8 2 8 2C8 2 5 6.34315 5 8Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                <path d="M12 3C12 4.65685 13.3431 6 15 6C16.6569 6 18 4.65685 18 3C18 1.34315 15 -3 15 -3C15 -3 12 1.34315 12 3Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" transform="translate(0 5)"/>
                            </svg>
                        </div>
                        <h2 class="card-title">Climate Data</h2>
                    </div>
                    <div class="card-body">
                        <div class="form-grid">
                            <div class="form-group">
                                <label for="temperature">Temperature (°C)</label>
                                <input type="number" id="temperature" placeholder="Average temperature" min="-20" max="50" step="0.1" required>
                            </div>
                            
                            <div class="form-group">
                                <label for="humidity">Humidity (%)</label>
                                <input type="number" id="humidity" placeholder="Average humidity" min="0" max="100" required>
                            </div>
                            
                            <div class="form-group full-width">
                                <label for="rainfall">Rainfall (mm)</label>
                                <input type="number" id="rainfall" placeholder="Annual rainfall" min="0" max="5000" required>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="button-container">
                    <button type="button" class="button" onclick="submitData()">Get Crop Recommendation</button>
                </div>
            </form>
            
            <div class="loading" id="loading">
                <div class="spinner"></div>
                <p>Analyzing your data...</p>
            </div>
            
            <div class="result-container" id="resultContainer">
                <div class="result-title">Based on your inputs, we recommend:</div>
                <div class="recommendations-grid" id="recommendations">
                    <!-- Recommendations will be inserted here -->
                </div>
            </div>
        </div>
    </div>

    <footer class="footer">
      <p>© 2025 EcoCropx | Precision Agriculture Technology</p>
    </footer>
    
    <script>
        window.onload = function() {
            const params = new URLSearchParams(window.location.search);
            if (params.has('city')) {
                document.getElementById("city").value = params.get('city');
                getWeather();
            }
        };
        
        async function getWeather() {
            let city = document.getElementById("city").value;
            if (city.length < 3) return;
            
            const apiKey = "233a169eca4c3d30d93928de0883ee9a";
            const url = `https://api.openweathermap.org/data/2.5/weather?q=${city}&appid=${apiKey}&units=metric`;
            
            try {
                let response = await fetch(url);
                let data = await response.json();
                if (data.main) {
                    document.getElementById("temperature").value = data.main.temp;
                    document.getElementById("humidity").value = data.main.humidity;
                } else {
                    console.error("City not found");
                }
            } catch (error) {
                console.error("Error fetching weather data:", error);
            }
        }
        
        function submitData() {
            // Validate inputs
            const form = document.getElementById("cropForm");
            const inputs = form.querySelectorAll("input");
            let isValid = true;
            
            inputs.forEach(input => {
                if (!input.value) {
                    input.style.borderColor = "var(--error)";
                    isValid = false;
                } else {
                    input.style.borderColor = "var(--gray-300)";
                }
            });
            
            if (!isValid) {
                alert("Please fill in all required fields.");
                return;
            }
            
            // Show loading
            document.getElementById("loading").classList.add("visible");
            document.getElementById("resultContainer").classList.remove("visible");
            
            let data = {
                city: document.getElementById("city").value,
                temperature: document.getElementById("temperature").value,
                humidity: document.getElementById("humidity").value,
                nitrogen: document.getElementById("nitrogen").value,
                phosphorus: document.getElementById("phosphorus").value,
                potassium: document.getElementById("potassium").value,
                ph: document.getElementById("ph").value,
                rainfall: document.getElementById("rainfall").value
            };
            
            fetch("/predict_crop", {
                method: "POST",
                headers: {
                    "Content-Type": "application/json"
                },
                body: JSON.stringify(data)
            })
            .then(response => response.json())
            .then(data => {
                // Hide loading
                document.getElementById("loading").classList.remove("visible");
                
                // Clear previous recommendations
                const recommendationsDiv = document.getElementById("recommendations");
                recommendationsDiv.innerHTML = "";
                
                // Add new recommendations
                data.recommendations.forEach((rec, index) => {
                    const recCard = document.createElement("div");
                    recCard.className = "recommendation-card";
                    recCard.innerHTML = `
                        <div class="rank">#${index + 1}</div>
                        <div class="crop-name">${rec.crop}</div>
                        <div class="probability">${rec.probability}% match</div>
                    `;
                    recommendationsDiv.appendChild(recCard);
                });
                
                // Show result container
                document.getElementById("resultContainer").classList.add("visible");
                
                // Scroll to result
                document.getElementById("resultContainer").scrollIntoView({
                    behavior: 'smooth'
                });
            })
            .catch(error => {
                console.error("Error:", error);
                document.getElementById("loading").classList.remove("visible");
                alert("An error occurred. Please try again.");
            });
        }

        const hamburger = document.querySelector('.mobile-menu');
    const navItems = document.querySelector('.nav-items');
    const overlay = document.getElementById('overlay');
    hamburger.addEventListener('click', () => {
      navItems.classList.toggle('active');
      hamburger.classList.toggle('active');
      overlay.classList.toggle('active');
    

      if( navItems.classList.contains('active')) {
        hamburger.innerHTML = '&#10005;'; // Change to close icon
      } else {
        hamburger.innerHTML = '&#9776;'; // Change back to menu icon
      }
    });

    overlay.addEventListener('click', () => {
      navItems.classList.remove('active');
      hamburger.classList.remove('active');
      overlay.classList.remove('active');
      hamburger.innerHTML = '&#9776;'; // Change back to menu icon
    });
    </script>
    



</body>
</html>
